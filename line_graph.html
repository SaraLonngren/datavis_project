<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Gráfico de linha</title>
    <link rel="stylesheet" href="css/dc.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/crossfilter.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="js/dc.min.js"></script>

</head>
<body>
     <div><h1>Gráfico de linha</h1>
        <div id="chart"></div>
    </div>

    <script type="text/javascript">
        var lineChart = dc.lineChart('#chart');

        d3.csv("line_chart_data2.csv").then(function(data){
        	           
			var parseDate = d3.timeParse("%d/%m/%Y");

			data.forEach(function(d){
                d.date = parseDate(d.date);
            });

      //       var colorScale = d3.scaleOrdinal()
						// .domain(["2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018"])
						// .range(["#666633", "#33cccc", "#cc3333", "#cc8033", "	#cc3333", "#29a329", "#ffcc66", "#660066"]);

            //criando um crossfilter
            var facts = crossfilter(data);

            // var yearDim = facts.dimension(function(d){
            //     return d.year;
            // });

            // var dateDim = facts.dimension(function(d){
            //     return d.date;
            // });

            var dateMonthDim = facts.dimension(function (d) {
            	return d.date.getMonth(); 
            });

            var amountDim = facts.dimension(function(d){
                return d.amount;
            });

	       	//    var amountGroup = yearDim.group().reduceSum(function(d) {
	        //    	return d.amount;
        	// });

        	// var dateAndAmountDim = facts.dimension(function(d){
        	// 	return d.amount, d.year;	
        	// });

        	var amountGroup = dateMonthDim.group().reduceSum(function(d){
        		return d.amount;
        	});       	

        	// var mediaGroup = dateAndAmountDim.group().reduceSum(function(d){
        	// 	return d.year;
        	// });

            // var xScale = d3.scaletime()
            //              .domain([dateMonthDim.bottom(1)[0].date, dateMonthDim.top(1)[0].date]);

            // var yScale = d3.scaletime()
            //              .domain([amountDim.bottom(1)[0], amountDim.top(1)[0]]);


            lineChart.width(800) 
            		 .height(400)
                     .margins({top: 50, right: 50, bottom: 25, left: 40})
                     .dimension(amountDim)
                    // .x(xScale)
                    // .y(yScale)
                     .xUnits(d3.timeDays)
                     .renderHorizontalGridLines(true)
                     //.legend(dc.legend().x(700).y(5).itemHeight(13).gap(5))
                     .brushOn(false)
                     .group(amountGroup)
                     
			   // .height(200)
			   // .clipPadding(10)
			   // .x(xScale)
			   // .y(yScale)
			   // .elasticY(true)
			   // .brushOn(false)
			   // .dimension(dateDim)
			   // .colors(colorScale)
			   // .renderHorizontalGridLines(true)
			   // .seriesAccessor(function(d) { return d.key[0];})
			   // .keyAccessor(function(d) { return d.key[1]; })
			   // .valueAccessor(function(d) { return d.value; })
			   // .legend(dc.legend().x(165).y(0).itemHeight(10).gap(5).horizontal(2).legendWidth(400).itemWidth(100));

            dc.renderAll();

        });
    </script>           
</body>
</html>